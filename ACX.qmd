---
title: Alternating Cyclic Extrapolation for MDS Acceleration
author: 
    - name: Jan de Leeuw
      orcid: 0000-0003-1420-1797
      email: jan@deleeuwpdx.net
      affiliation: 
        - name: University of California Los Angeles
          city: Los Angeles
          state: CA
          url: www.ucla.edu
      license: "CC0"
date: last-modified
date-format: long
bibliography: [mypubs.bib, total.bib]
number-sections: true
pdf-engine: lualatex
keep-tex: true
format:
   pdf:
    fontsize: 12pt
    include-in-header: 
     - preamble.tex
    keep-tex: true
    link-citations: true
    documentclass: scrartcl
    number-sections: true
   html:
    fontsize: 12pt
    include-in-header: 
     - preamble.css
    keep-md: true
    number-sections: true
toc: true
toc-depth: 3
editor: source
papersize: letter
graphics: true
link-citations: true
mainfont: Times New Roman
abstract: TBD
---

```{r loadpackages, echo = FALSE}
suppressPackageStartupMessages(library(knitr, quietly = TRUE))
suppressPackageStartupMessages(library(tinytex, quietly = TRUE))
suppressPackageStartupMessages(library(RSpectra, quietly = TRUE))
suppressPackageStartupMessages(library(microbenchmark, quietly = TRUE))
```

```{r loadsources, echo = FALSE}
source("smacofACX.R")
source("acxEkman.R")
source("acxGruijter.R")
source("acxMorse.R")
```

**Note:** This is a working manuscript which will be expanded/updated
frequently. All suggestions for improvement are welcome. All Rmd, tex,
html, pdf, R, and C files are in the public domain. Attribution will be
appreciated, but is not required. The files can be found at
<https://github.com/deleeuw/ACX> 

\sectionbreak

# Introduction

@ramsay_75
@groenen_glunt_hayden_96
@rosman_bronstein_bronstein_sidi_kimmel_08
@deleeuw_R_06b
@deleeuw_R_08i


@lepage_saucier_24

\begin{align}
\Delta_0^{(k)}&=X^{(k)},\\
\Delta_1^{(k)}&=\Gamma(X^{(k)})-X^{(k)},\\
\Delta_2^{(k)}&=\Gamma^2(X^{(k)})-2\Gamma(X^{(k)})+X^{(k)},\\
\Delta_3^{(k)}&=\Gamma^3(X^{(k)})-3\Gamma^2(X^{(k)})+3\Gamma(X^{(k)})-X^{(k)}.
\end{align}


# Iterations

We iterate a maximum of 1000 times and we stop if the sup-norm $\|X^{(k+1)}-X^{(k)}\|_\infty$ is less than  $10^{-6}$. This is a much stricter stop citerium as the one used in *smacof*, which stops if the change in loss function value 
$\sigma^{(k)}-\sigma^{(k+1)}$ is less than 
$10^{-6}$. We always start with the classical scaling (Torgerson-Gower) solution.


## Strategy (x)

```{r xF, cache = TRUE, echo = FALSE}
he0 <- smacofACX(ekman, strategy = 0, verbose = FALSE, safe = FALSE)
he1 <- smacofACX(ekman, strategy = 1, verbose = FALSE, safe = FALSE)
he2 <- smacofACX(ekman, strategy = 2, verbose = FALSE, safe = FALSE)
he3 <- smacofACX(ekman, strategy = 3, verbose = FALSE, safe = FALSE)
hg0 <- smacofACX(gruijter, strategy = 0, verbose = FALSE, safe = FALSE)
hg1 <- smacofACX(gruijter, strategy = 1, verbose = FALSE, safe = FALSE)
hg2 <- smacofACX(gruijter, strategy = 2, verbose = FALSE, safe = FALSE)
hg3 <- smacofACX(gruijter, strategy = 3, verbose = FALSE, safe = FALSE)
hm0 <- smacofACX(morse, strategy = 0, verbose = FALSE, safe = FALSE)
hm1 <- smacofACX(morse, strategy = 1, verbose = FALSE, safe = FALSE)
hm2 <- smacofACX(morse, strategy = 2, verbose = FALSE, safe = FALSE)
hm3 <- smacofACX(morse, strategy = 3, verbose = FALSE, safe = FALSE)
h<-matrix(c(he0$itel, he1$itel, he2$itel, he3$itel,
        hg0$itel, hg1$itel, hg2$itel, hg3$itel,
        hm0$itel, hm1$itel, hm2$itel, hm3$itel
        ), 3, 4, byrow = TRUE)
row.names(h) <- c("ekman", "gruijter", "morse")
```

```{r kxF, echo = FALSE, tab.align = "center"}
kable(h, row.names = TRUE, col.names = c("(0)", "(1)", "(2)", "(3)"),
      caption = "strategy (x), safe = FALSE")
```

```{r xT, cache = TRUE, echo = FALSE}
he0 <- smacofACX(ekman, strategy = 0, verbose = FALSE, safe = TRUE)
he1 <- smacofACX(ekman, strategy = 1, verbose = FALSE, safe = TRUE)
he2 <- smacofACX(ekman, strategy = 2, verbose = FALSE, safe = TRUE)
he3 <- smacofACX(ekman, strategy = 3, verbose = FALSE, safe = TRUE)
hg0 <- smacofACX(gruijter, strategy = 0, verbose = FALSE, safe = TRUE)
hg1 <- smacofACX(gruijter, strategy = 1, verbose = FALSE, safe = TRUE)
hg2 <- smacofACX(gruijter, strategy = 2, verbose = FALSE, safe = TRUE)
hg3 <- smacofACX(gruijter, strategy = 3, verbose = FALSE, safe = TRUE)
hm0 <- smacofACX(morse, strategy = 0, verbose = FALSE, safe = TRUE)
hm1 <- smacofACX(morse, strategy = 1, verbose = FALSE, safe = TRUE)
hm2 <- smacofACX(morse, strategy = 2, verbose = FALSE, safe = TRUE)
hm3 <- smacofACX(morse, strategy = 3, verbose = FALSE, safe = TRUE)
h<-matrix(c(he0$itel, he1$itel, he2$itel, he3$itel,
        hg0$itel, hg1$itel, hg2$itel, hg3$itel,
        hm0$itel, hm1$itel, hm2$itel, hm3$itel
        ), 3, 4, byrow = TRUE)
row.names(h) <- c("ekman", "gruijter", "morse")
```

```{r kxT, echo = FALSE, tab.align = "center"}
kable(h, row.names = TRUE, col.names = c("(0,0)", "(1,1)", "(2,2)", "(3,3)"),
      caption = "strategy (x), safe = TRUE")
```

## Strategy (0,x)

```{r 0xF, cache = TRUE, echo = FALSE}
he1 <- smacofACX(ekman, strategy = c(0,1), verbose = FALSE, safe = FALSE)
he2 <- smacofACX(ekman, strategy = c(0,2), verbose = FALSE, safe = FALSE)
he3 <- smacofACX(ekman, strategy = c(0,3), verbose = FALSE, safe = FALSE)
hg1 <- smacofACX(gruijter, strategy = c(0,1), verbose = FALSE, safe = FALSE)
hg2 <- smacofACX(gruijter, strategy = c(0,2), verbose = FALSE, safe = FALSE)
hg3 <- smacofACX(gruijter, strategy = c(0,3), verbose = FALSE, safe = FALSE)
hm1 <- smacofACX(morse, strategy = c(0,1), verbose = FALSE, safe = FALSE)
hm2 <- smacofACX(morse, strategy = c(0,2), verbose = FALSE, safe = FALSE)
hm3 <- smacofACX(morse, strategy = c(0,3), verbose = FALSE, safe = FALSE)
h<-matrix(c(he0$itel, he1$itel, he2$itel, he3$itel,
        hg0$itel, hg1$itel, hg2$itel, hg3$itel,
        hm0$itel, hm1$itel, hm2$itel, hm3$itel
        ), 3, 4, byrow = TRUE)
row.names(h) <- c("ekman", "gruijter", "morse")
```

```{r k0xF, echo = FALSE, tab.align = "center"}
kable(h, row.names = TRUE, col.names = c("(0,0)", "(0,1)", "(0,2)", "(0,3)"),
      caption = "strategy (0,x), safe = FALSE")
```


```{r 0xT, cache = TRUE, echo = FALSE}
he1 <- smacofACX(ekman, strategy = c(0,1), verbose = FALSE, safe = TRUE)
he2 <- smacofACX(ekman, strategy = c(0,2), verbose = FALSE, safe = TRUE)
he3 <- smacofACX(ekman, strategy = c(0,3), verbose = FALSE, safe = TRUE)
hg1 <- smacofACX(gruijter, strategy = c(0,1), verbose = FALSE, safe = TRUE)
hg2 <- smacofACX(gruijter, strategy = c(0,2), verbose = FALSE, safe = TRUE)
hg3 <- smacofACX(gruijter, strategy = c(0,3), verbose = FALSE, safe = TRUE)
hm1 <- smacofACX(morse, strategy = c(0,1), verbose = FALSE, safe = TRUE)
hm2 <- smacofACX(morse, strategy = c(0,2), verbose = FALSE, safe = TRUE)
hm3 <- smacofACX(morse, strategy = c(0,3), verbose = FALSE, safe = TRUE)
h<-matrix(c(he0$itel, he1$itel, he2$itel, he3$itel,
        hg0$itel, hg1$itel, hg2$itel, hg3$itel,
        hm0$itel, hm1$itel, hm2$itel, hm3$itel
        ), 3, 4, byrow = TRUE)
row.names(h) <- c("ekman", "gruijter", "morse")
```

```{r k0xT, echo = FALSE, tab.align = "center"}
kable(h, row.names = TRUE, col.names = c("(0,0)", "(0,1)", "(0,2)", "(0,3)"),
      caption = "strategy (0,x), safe = TRUE")
```


## Strategy (x,x)

```{r xxF, cache = TRUE, echo = FALSE}
he1 <- smacofACX(ekman, strategy = c(1,1), verbose = FALSE, safe = FALSE)
he2 <- smacofACX(ekman, strategy = c(2,2), verbose = FALSE, safe = FALSE)
he3 <- smacofACX(ekman, strategy = c(3,3), verbose = FALSE, safe = FALSE)
hg1 <- smacofACX(gruijter, strategy = c(1,1), verbose = FALSE, safe = FALSE)
hg2 <- smacofACX(gruijter, strategy = c(2,2), verbose = FALSE, safe = FALSE)
hg3 <- smacofACX(gruijter, strategy = c(3,3), verbose = FALSE, safe = FALSE)
hm1 <- smacofACX(morse, strategy = c(1,1), verbose = FALSE, safe = FALSE)
hm2 <- smacofACX(morse, strategy = c(2,2), verbose = FALSE, safe = FALSE)
hm3 <- smacofACX(morse, strategy = c(3,3), verbose = FALSE, safe = FALSE)
h<-matrix(c(he0$itel, he1$itel, he2$itel, he3$itel,
        hg0$itel, hg1$itel, hg2$itel, hg3$itel,
        hm0$itel, hm1$itel, hm2$itel, hm3$itel
        ), 3, 4, byrow = TRUE)
row.names(h) <- c("ekman", "gruijter", "morse")
```

```{r kxxF, echo = FALSE, tab.align = "center"}
kable(h, row.names = TRUE, col.names = c("(0,0)", "(1,1)", "(2,2)", "(3,3)"),
      caption = "strategy (x,x), safe = FALSE")
```


```{r xxT, cache = TRUE, echo = FALSE}
he1 <- smacofACX(ekman, strategy = c(1,1), verbose = FALSE, safe = TRUE)
he2 <- smacofACX(ekman, strategy = c(2,2), verbose = FALSE, safe = TRUE)
he3 <- smacofACX(ekman, strategy = c(3,3), verbose = FALSE, safe = TRUE)
hg1 <- smacofACX(gruijter, strategy = c(1,1), verbose = FALSE, safe = TRUE)
hg2 <- smacofACX(gruijter, strategy = c(2,2), verbose = FALSE, safe = TRUE)
hg3 <- smacofACX(gruijter, strategy = c(3,3), verbose = FALSE, safe = TRUE)
hm1 <- smacofACX(morse, strategy = c(1,1), verbose = FALSE, safe = TRUE)
hm2 <- smacofACX(morse, strategy = c(2,2), verbose = FALSE, safe = TRUE)
hm3 <- smacofACX(morse, strategy = c(3,3), verbose = FALSE, safe = TRUE)
h<-matrix(c(he0$itel, he1$itel, he2$itel, he3$itel,
        hg0$itel, hg1$itel, hg2$itel, hg3$itel,
        hm0$itel, hm1$itel, hm2$itel, hm3$itel
        ), 3, 4, byrow = TRUE)
row.names(h) <- c("ekman", "gruijter", "morse")
```

```{r kxxT, echo = FALSE, tab.align = "center"}
kable(h, row.names = TRUE, col.names = c("(0,0)", "(1,1)", "(2,2)", "(3,3)"),
      caption = "strategy (x,x), safe = TRUE")
```


\sectionbreak 

# Timing

## Strategy (x)

```{r mxF, echo = FALSE, cache = TRUE}
suppressWarnings(
h <- microbenchmark(
smacofACX(ekman, strategy = 0, verbose = FALSE, safe = FALSE),
smacofACX(ekman, strategy = 1, verbose = FALSE, safe = FALSE),
smacofACX(ekman, strategy = 2, verbose = FALSE, safe = FALSE),
smacofACX(ekman, strategy = 3, verbose = FALSE, safe = FALSE),
smacofACX(gruijter, strategy = 0, verbose = FALSE, safe = FALSE),
smacofACX(gruijter, strategy = 1, verbose = FALSE, safe = FALSE),
smacofACX(gruijter, strategy = 2, verbose = FALSE, safe = FALSE),
smacofACX(gruijter, strategy = 3, verbose = FALSE, safe = FALSE),
smacofACX(morse, strategy = 0, verbose = FALSE, safe = FALSE),
smacofACX(morse, strategy = 1, verbose = FALSE, safe = FALSE),
smacofACX(morse, strategy = 2, verbose = FALSE, safe = FALSE),
smacofACX(morse, strategy = 3, verbose = FALSE, safe = FALSE)))
```

```{r pxF, echo = FALSE, tab.align = "center"}
mh <- matrix(c(2186,62585,2179,640, 35126, 29192,26243,3863,36342,62532,23141,4606), 3, 4, byrow = TRUE)
row.names(mh) <- c("ekman", "gruijter", "morse")
kable(mh, row.names = TRUE, col.names = c("(0)", "(1)", "(2)", "(3)"),
      caption = "strategy (x), safe = FALSE")
```

```{r mxT, echo = FALSE, cache = TRUE}
suppressWarnings(h <- microbenchmark(
smacofACX(ekman, strategy = 0, verbose = FALSE, safe = TRUE),
smacofACX(ekman, strategy = 1, verbose = FALSE, safe = TRUE),
smacofACX(ekman, strategy = 2, verbose = FALSE, safe = TRUE),
smacofACX(ekman, strategy = 3, verbose = FALSE, safe = TRUE),
smacofACX(gruijter, strategy = 0, verbose = FALSE, safe = TRUE),
smacofACX(gruijter, strategy = 1, verbose = FALSE, safe = TRUE),
smacofACX(gruijter, strategy = 2, verbose = FALSE, safe = TRUE),
smacofACX(gruijter, strategy = 3, verbose = FALSE, safe = TRUE),
smacofACX(morse, strategy = 0, verbose = FALSE, safe = TRUE),
smacofACX(morse, strategy = 1, verbose = FALSE, safe = TRUE),
smacofACX(morse, strategy = 2, verbose = FALSE, safe = TRUE),
smacofACX(morse, strategy = 3, verbose = FALSE, safe = TRUE)))
```
```{r pxT, echo = FALSE, tab.align = "center"}
mh <- matrix(c(2169,1213,2216,630, 35294,25816,23236,2813,36311,25238,24526,4209), 3, 4, byrow = TRUE)
row.names(mh) <- c("ekman", "gruijter", "morse")
kable(mh, row.names = TRUE, col.names = c("(0)", "(1)", "(2)", "(3)"),
      caption = "strategy (x), safe = TRUE")
```

## Strategy (0,x)

```{r m0xF, cache = TRUE, echo = FALSE}
suppressWarnings(h <- microbenchmark(
smacofACX(ekman, strategy = c(0,1), verbose = FALSE, safe = FALSE),
smacofACX(ekman, strategy = c(0,2), verbose = FALSE, safe = FALSE),
smacofACX(ekman, strategy = c(0,3), verbose = FALSE, safe = FALSE),
smacofACX(gruijter, strategy = c(0,1), verbose = FALSE, safe = FALSE),
smacofACX(gruijter, strategy = c(0,2), verbose = FALSE, safe = FALSE),
smacofACX(gruijter, strategy = c(0,3), verbose = FALSE, safe = FALSE),
smacofACX(morse, strategy = c(0,1), verbose = FALSE, safe = FALSE),
smacofACX(morse, strategy = c(0,2), verbose = FALSE, safe = FALSE),
smacofACX(morse, strategy = c(0,3), verbose = FALSE, safe = FALSE)))
```
```{r p0xF, echo = FALSE, tab.align = "center"}
mh <- matrix(c(1572,1974,723,26792,17851,2701,26233,19504,3909), 3, 3, byrow = TRUE)
row.names(mh) <- c("ekman", "gruijter", "morse")
kable(mh, row.names = TRUE, col.names = c("(0,1)", "(0,2)", "(0,3)"),
      caption = "strategy (0,x), safe = FALSE")
```

```{r m0xT, cache = TRUE, echo = FALSE}
suppressWarnings(h <- microbenchmark(
smacofACX(ekman, strategy = c(0,1), verbose = FALSE, safe = TRUE),
smacofACX(ekman, strategy = c(0,2), verbose = FALSE, safe = TRUE),
smacofACX(ekman, strategy = c(0,3), verbose = FALSE, safe = TRUE),
smacofACX(gruijter, strategy = c(0,1), verbose = FALSE, safe = TRUE),
smacofACX(gruijter, strategy = c(0,2), verbose = FALSE, safe = TRUE),
smacofACX(gruijter, strategy = c(0,3), verbose = FALSE, safe = TRUE),
smacofACX(morse, strategy = c(0,1), verbose = FALSE, safe = TRUE),
smacofACX(morse, strategy = c(0,2), verbose = FALSE, safe = TRUE),
smacofACX(morse, strategy = c(0,3), verbose = FALSE, safe = TRUE)))
```
```{r p0xT, echo = FALSE, tab.align = "center"}
mh <- matrix(c(1528,2105,698,26682,17546,2917,26183,18950,3708), 3, 3, byrow = TRUE)
row.names(mh) <- c("ekman", "gruijter", "morse")
kable(mh, row.names = TRUE, col.names = c("(0,1)", "(0,2)", "(0,3)"),
      caption = "strategy (0,x), safe = TRUE")
```

# References




